/*
Copyright (c) Daybrush
name: @scena/ruler
license: MIT
author: Daybrush
repository: git+https://github.com/daybrush/ruler.git
version: 0.18.3
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).Ruler=e()}(this,function(){"use strict";var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var c=function(){return(c=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(e,n){return function(t){t&&(e[n]=t)}}var M="function",B="object",L="string",N="undefined",u={cm:function(t){return 96*t/2.54},mm:function(t){return 96*t/254},in:function(t){return 96*t},pt:function(t){return 96*t/72},pc:function(t){return 96*t/6},"%":function(t,e){return t*e/100},vw:function(t,e){return t/100*(e=void 0===e?window.innerWidth:e)},vh:function(t,e){return t/100*(e=void 0===e?window.innerHeight:e)},vmax:function(t,e){return t/100*(e=void 0===e?Math.max(window.innerWidth,window.innerHeight):e)},vmin:function(t,e){return t/100*(e=void 0===e?Math.min(window.innerWidth,window.innerHeight):e)}};function v(t){return typeof t===L}function C(t,r){return void 0===r&&(r="-"),t.replace(/([a-z])([A-Z])/g,function(t,e,n){return""+e+r+n.toLowerCase()})}function et(t,e){e=function(t,e,n){void 0===n&&(n=-1);for(var r=t.length-1;0<=r;--r)if(e(t[r],r,t))return r;return n}(t,e);-1<e&&t[e]}function U(t,e,n){e=function(t,e,n){void 0===n&&(n=-1);for(var r=t.length,o=0;o<r;++o)if(e(t[o],o,t))return o;return n}(t,e);return-1<e?t[e]:n}function l(t){return Object.keys(t)}function tt(t,e){var n=(t=/^([^\d|e|\-|\+]*)((?:\d|\.|-|e-|e\+)+)(\S*)$/g.exec(t=t))?(n=t[1],r=t[2],{prefix:n,unit:t[3],value:parseFloat(r)}):{prefix:"",unit:"",value:NaN},t=n.value,r=n.unit;if((o=e)&&typeof o===B){var o=e[r];if(o){if(typeof o===M)return o(t);if(u[r])return u[r](t,o)}}else if("%"===r)return t*e/100;return u[r]?u[r](t):t}function a(t,e,n,r){t.removeEventListener(e,n,r)}var W=function(){function t(){this.keys=[],this.values=[]}var e=t.prototype;return e.get=function(t){return this.values[this.keys.indexOf(t)]},e.set=function(t,e){var n=this.keys,r=this.values,o=n.indexOf(t),o=-1===o?n.length:o;n[o]=t,r[o]=e},t}(),D=function(){function t(){this.object={}}var e=t.prototype;return e.get=function(t){return this.object[t]},e.set=function(t,e){this.object[t]=e},t}(),I="function"==typeof Map,H=function(){function t(){}var e=t.prototype;return e.connect=function(t,e){this.prev=t,this.next=e,t&&(t.next=this),e&&(e.prev=this)},e.disconnect=function(){var t=this.prev,e=this.next;t&&(t.next=e),e&&(e.prev=t)},e.getIndex=function(){for(var t=this,e=-1;t;)t=t.prev,++e;return e},t}();var F=function(){function t(t,e,n,r,o,i,c,s){this.prevList=t,this.list=e,this.added=n,this.removed=r,this.changed=o,this.maintained=i,this.changedBeforeAdded=c,this.fixed=s}var e=t.prototype;return Object.defineProperty(e,"ordered",{get:function(){return this.cacheOrdered||this.caculateOrdered(),this.cacheOrdered},enumerable:!0,configurable:!0}),Object.defineProperty(e,"pureChanged",{get:function(){return this.cachePureChanged||this.caculateOrdered(),this.cachePureChanged},enumerable:!0,configurable:!0}),e.caculateOrdered=function(){t=this.changedBeforeAdded,n=this.fixed,o=[],i=[],t.forEach(function(t){var e=t[0],t=t[1],n=new H;i[t]=o[e]=n}),o.forEach(function(t,e){t.connect(o[e-1])});var n,o,i,t=t.filter(function(t,e){return!n[e]}).map(function(t,e){var n,r=t[0],t=t[1];return r===t?[0,0]:(t=i[t-1],n=(r=o[r]).getIndex(),r.disconnect(),t?r.connect(t,t.next):r.connect(void 0,o[0]),[n,r.getIndex()])}),c=this.changed,s=[];this.cacheOrdered=t.filter(function(t,e){var n=t[0],t=t[1],e=c[e],r=e[0],e=e[1];if(n!==t)return s.push([r,e]),!0}),this.cachePureChanged=s},t}();function y(t,e,n){var r=I?Map:n?D:W,n=n||function(t){return t},o=[],i=[],c=[],s=t.map(n),n=e.map(n),u=new r,a=new r,l=[],f=[],h={},p=[],d=0,v=0;return s.forEach(function(t,e){u.set(t,e)}),n.forEach(function(t,e){a.set(t,e)}),s.forEach(function(t,e){t=a.get(t);void 0===t?(++v,i.push(e)):h[t]=v}),n.forEach(function(t,e){t=u.get(t);void 0===t?(o.push(e),++d):(c.push([t,e]),v=h[e]||0,l.push([t-v,e-d]),f.push(e===t),t!==e&&p.push([t,e]))}),i.reverse(),new F(t,e,o,i,p,c,l,f)}var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var g=function(){return(g=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function f(t,e){var n={};for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&e.indexOf(o)<0&&(n[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var r=0,o=Object.getOwnPropertySymbols(t);r<o.length;r++)e.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(n[o[r]]=t[o[r]]);return n}function _(t,e,n){if(n||2===arguments.length)for(var r,o=0,i=e.length;o<i;o++)!r&&o in e||((r=r||Array.prototype.slice.call(e,0,o))[o]=e[o]);return t.concat(r||Array.prototype.slice.call(e))}function m(t){var e=0;return t.map(function(t){return null==t?"$compat".concat(++e):"".concat(t)})}function h(t){var e=[];return t.forEach(function(t){e=e.concat(Array.isArray(t)?h(t):t)}),e}function b(t,e){if(e)for(var n in e)typeof t[n]===N&&(t[n]=e[n]);return t}function p(t,e){if(t!==e){for(var n in t)if(!(n in e))return!0;for(var n in e)if(t[n]!==e[n])return!0}return!1}function E(t){var e=t.className,t=f(t,["className"]);return null!=e&&(t.class=e),delete t.style,delete t.children,t}function R(t){var e,n={},r={};for(e in t)0===e.indexOf("on")?r[e]=t[e]:n[e]=t[e];return[n,r]}function k(t){var e;return t?(e=t.b)instanceof Node?e:k(t.c):null}function d(t){var e=t.parentNode;e&&e.removeChild(t)}function x(t){t.forEach(function(t){t()})}function q(){return this.constructor(this.props,this.context)}var t=function(){function t(t,e,n,r,o,i,c){void 0===c&&(c={}),this.t=t,this.d=e,this.k=n,this.i=r,this.c=o,this.ref=i,this.ps=c,this.typ="prov",this._ps=[],this._cs={},this._hyd=null,this._sel=!1}var e=t.prototype;return e.s=function(){return!0},e.u=function(e,n,t,r,o){var i,c=this,s=c.d,u=h(l(i=n).map(function(t){return i[t]}).filter(function(t){return t.$_req}).map(function(t){return t.$_subs})),a=U(u,function(t){return t.d===s});if(c.b&&!v(t)&&!o&&!c.s(t.props,r)&&!a)return u.reduce(function(t,e){var n=e.d;return t[0]?t[0].d===n&&t.push(e):s<n&&t.push(e),t},[]).forEach(function(t){T(t,t._ps,[t.o],e,n,!0)}),!1;c.o=t,c.ss(r);o=c.ps;return v(t)||(c.ps=t.props,c.ref=t.ref),c.r(e,n,c.b?o:{},r),!0},e.md=function(){this.rr()},e.ss=function(){},e.ud=function(){this.rr()},e.rr=function(){var t=this.ref,e=this.fr;t&&t(e?e.current:this.b)},t}(),w=function(){function t(t,e){this.props=t=void 0===t?{}:t,this.context=e,this.state={},this.$_timer=0,this.$_state={},this.$_subs=[],this.$_cs={}}var e=t.prototype;return e.render=function(){return null},e.shouldComponentUpdate=function(t,e){return this.props!==t||this.state!==e},e.setState=function(t,e,n){var r=this;r.$_timer||(r.$_state={}),clearTimeout(r.$_timer),r.$_timer=0,r.$_state=g(g({},r.$_state),t),n?r.$_setState(e,n):r.$_timer=window.setTimeout(function(){r.$_timer=0,r.$_setState(e,n)})},e.forceUpdate=function(t){this.setState({},t,!0)},e.componentDidMount=function(){},e.componentDidUpdate=function(t,e){},e.componentWillUnmount=function(){},e.$_setState=function(t,e){var n=[],r=this.$_p;T(r.c,[r],[r.o],n,r._cs,g(g({},this.state),this.$_state),e)&&(t&&n.push(t),x(n))},t}(),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.shouldComponentUpdate=function(t,e){return p(this.props,t)||p(this.state,e)},e}(w);function V(t){function e(t){e.current=t}return e.current=t,e}var Z=function(s){function t(t,e,n,r,o,i,c){e=s.call(this,t,e,n,r,o,i,b(c=void 0===c?{}:c,t.defaultProps))||this;return e.typ="comp",e._usefs=[],e._uefs=[],e._defs=[],e}o(t,s);var e=t.prototype;return e.s=function(t,e){var n=this.b;return!1!==n.shouldComponentUpdate(b(t,this.t.defaultProps),e||n.state)},e.r=function(t,e,n){var r,o,i,c,s=this,u=s.t,a=(s.ps=b(s.ps,s.t.defaultProps),s.ps),l=!s.b,f=u.contextType,h=s.b,p=null==f?void 0:f.get(s),d=(s._cs=e,l?(r=a,o=p,i=s,null!=(v=null==(u=u)?void 0:u.prototype)&&v.render?c=new u(r,o):((c=new w(r,o)).constructor=u)._fr?(i.fr=V(),c.render=function(){return this.constructor(this.props,i.fr)}):c.render=q,c.$_p=i,h=c,s.b=h):(h.props=a,h.context=p),h.state),v=(s._usefs=[],s._uefs=[],h.render()),u=(0===(null==(o=null==(r=null==v?void 0:v.props)?void 0:r.children)?void 0:o.length)&&(v.props.children=s.ps.children),g(g({},e),h.$_cs));T(s,s._ps,v?[v]:[],t,u),l?s._uefs.push(function(){null!=f&&f.register(s),h.componentDidMount()}):s._uefs.push(function(){h.componentDidUpdate(n,d)}),t.push(function(){s._usefs.forEach(function(t){t()}),l?s.md():s.ud(),s._defs=s._uefs.map(function(t){return t()})})},e.ss=function(t){var e=this.b;e&&t&&(e.state=t)},e.un=function(){var t,e=this;e._ps.forEach(function(t){t.un()}),null!=(t=e.t.contextType)&&t.unregister(e),clearTimeout(e.b.$_timer),e._defs.forEach(function(t){t&&t()}),e.b.componentWillUnmount()},t}(t);function z(n,r){var o=l(n),e=l(r),t=y(o,e,function(t){return t}),i={},c={},s={};return t.added.forEach(function(t){t=e[t];i[t]=r[t]}),t.removed.forEach(function(t){t=o[t];c[t]=n[t]}),t.maintained.forEach(function(t){var t=t[0],t=o[t],e=[n[t],r[t]];n[t]!==r[t]&&(s[t]=e)}),{added:i,removed:c,changed:s}}var J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.typ="elem",t._es={},t._svg=!1,t}o(t,e);var n=t.prototype;return n.e=function(r,t){var e,o=this,n=o._es,i=o.b,c=r.replace(/^on/g,"").toLowerCase();t?(a(i,c,n[r]),delete n[r]):(n[r]=function(t){var e,n;null!=(n=(e=o.ps)[r])&&n.call(e,t)},t=n[r],i.addEventListener(c,t,e))},n.s=function(t){return p(this.ps,t)},n.r=function(t,e,n){var r,o,i,c=this,s=!c.b,u=c.ps,a=(s&&(a=!1,a=!(!c._svg&&"svg"!==c.t)||(f=k(c.c))&&f.ownerSVGElement,c._svg=a,(f=u.portalContainer)||(f=null==(l=c._hyd)?void 0:l.splice(0,1)[0],l=c.t,f?c._hyd=[].slice.call(f.children):f=a?document.createElementNS("http://www.w3.org/2000/svg",l):document.createElement(l)),c.b=f),T(c,c._ps,u.children,t,e),c.b),l=R(n),f=l[0],e=l[1],l=R(u),h=l[0],l=l[1],p=a,d=(f=z(E(f),E(h))).added,h=f.removed,v=f.changed;for(r in d)p.setAttribute(r,d[r]);for(o in v)p.setAttribute(o,v[o][1]);for(i in h)p.removeAttribute(i);var y,g,h=e,_=c,e=(h=z(e,e=l)).added;for(y in h.removed)_.e(y,!0);for(g in e)_.e(g);var m,h=n.style||{},e=u.style||{},n=a,b=n.style,x=(n=z(h,e)).added,h=n.removed,w=n.changed;for(m in x){var O=C(m,"-");b.setProperty(O,x[m])}for(m in w){var S=C(m,"-");b.setProperty(S,w[m][1])}for(m in h){var P=C(m,"-");b.removeProperty(P)}return t.push(function(){s?c.md():c.ud()}),!0},n.un=function(){var t,e=this,n=e._es,r=e.b;for(t in n)a(r,t,n[t]);e._ps.forEach(function(t){t.un()}),e._es={},e.ps.portalContainer||e._sel||(console.log(r),d(r))},t}(t);function O(t){return!t||t instanceof Node?t:(t=t.$_p._ps).length?O(t[0].b):null}function S(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var e=e||{},o=e.key,i=e.ref,e=f(e,["key","ref"]);return{type:t,key:o,ref:i,props:g(g({},e),{children:n.reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return null!=t&&!1!==t})})}}var P=function(n){function t(t,e){e=n.call(this,"container",e=void 0===e?0:e,"container",0,null)||this;return e.typ="container",e.b=t,e}o(t,n);var e=t.prototype;return e.r=function(){return!0},e.un=function(){},t}(t),K=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.typ="text",t}o(t,e);var n=t.prototype;return n.r=function(t){var e,n=this,r=!n.b;return r&&(e=null==(e=n._hyd)?void 0:e.splice(0,1)[0],n.b=e||document.createTextNode(n.t.replace("text_",""))),t.push(function(){r?n.md():n.ud()}),!0},n.un=function(){d(this.b)},t}(t);function j(t,e,n,r){var o,i=r.d+1;return v(t)||"number"==typeof t?new K("text_".concat(t),i,e,n,r,null,{}):new("string"==typeof(o=t.type)?J:Z)(o,i,e,n,r,t.ref,t.props)}function T(n,r,o,i,c,s,u){a=n,l=r,h=(f=o).map(function(t){return v(t)?null:t.key}),(t=y(m(l.map(function(t){return t.k})),m(h),function(t){return t})).removed.forEach(function(t){l.splice(t,1)[0].un()}),t.ordered.forEach(function(t){var e=t[0],t=t[1],e=l.splice(e,1)[0],e=(l.splice(t,0,e),O(e.b)),t=O(l[t+1]&&l[t+1].b);e&&e.parentNode.insertBefore(e,t)}),t.added.forEach(function(t){l.splice(t,0,j(f[t],h[t],t,a))}),e=t.maintained.filter(function(t){t[0];var t=t[1],e=f[t],n=l[t];return(v(e)?"text_".concat(e):e.type)!==n.t?(n.un(),l.splice(t,1,j(e,h[t],t,a)),!0):(n.i=t,!1)});var a,l,f,h,t=_(_([],t.added,!0),e.map(function(t){return t[0],t[1]}),!0),p=n._hyd,e=r.filter(function(t,e){return t._hyd=p,t.u(i,c,o[e],s,u)}),d=("container"===n.typ&&n._sel&&r.forEach(function(t){t=function t(e){if(e)return e.b&&e.b instanceof Node?e:(e=e._ps).length?t(e[0]):null}(t);t&&(t._sel=!0)}),n._hyd=null,k(n));return d&&t.reverse().forEach(function(t){var t=r[t],e=O(t.b);e&&d!==e&&!e.parentNode&&(t=function(t,e){for(var n=t._ps,r=n.length,o=e.i+1;o<r;++o){var i=O(n[o].b);if(i)return i}return null}(n,t),d.insertBefore(e,t))}),0<e.length}function $(t,e,n){var r,o,i;!n&&t&&((n=new P(e.parentElement))._hyd=[e],n._sel=!0),t=t,e=e,void 0===r&&(r={}),o=!!(n=void 0===(n=n)?e.__CROACT__:n),i=[],T(n=n||new P(e),n._ps,t?[t]:[],i,r,void 0,void 0),x(i),o||(e.__CROACT__=n)}var A=function(t,e){return(A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};var e,Q=function(e){var t=o,n=e;if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={scrollPos:0},t.width=0,t.height=0,t._zoom=0,t._rulerScale=0,t._observer=null,t._checkResize=function(){t.resize()},t}A(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r);n=o.prototype;return n.render=function(){var t=this.props;return this._zoom=t.zoom,S("canvas",{ref:s(this,"canvasElement"),style:this.props.style})},n.componentDidMount=function(){var t=this.props,e=(this.state.scrollPos=t.defaultScrollPos||0,this.canvasElement),n=e.getContext("2d",{alpha:!1});this.canvasContext=n,t.useResizeObserver?(this._observer=new ResizeObserver(this._checkResize),this._observer.observe(e,{box:"border-box"})):this.resize()},n.componentDidUpdate=function(){this.resize()},n.componentWillUnmount=function(){var t;this.state.scrollPos=0,null!=(t=this._observer)&&t.disconnect()},n.getScrollPos=function(){return this.state.scrollPos},n.scroll=function(t,e){this.draw(t,e)},n.resize=function(t){var e=this.canvasElement,n=this.props,r=n.width,o=n.height,n=n.scrollPos,i=this._getRulerScale();this.width=r||e.offsetWidth,this.height=o||e.offsetHeight,e.width=this.width*i,e.height=this.height*i,this.draw(n,t)},n.draw=function(a,l){void 0===a&&(a=this.state.scrollPos),void 0===l&&(l=this._zoom),this._zoom=l;var t=this.props,f=t.unit,e=t.type,n=t.backgroundColor,B=t.lineColor,L=t.textColor,N=t.textBackgroundColor,h=t.direction,r=t.negativeRuler,U=void 0===r||r,r=t.segment,o=void 0===r?10:r,i=t.textFormat,r=t.range,p=void 0===r?[-1/0,1/0]:r,r=t.rangeBackgroundColor,c=t.selectedRanges,W=t.selectedBackgroundColor,s=t.lineWidth,s=void 0===s?1:s,D=t.selectedRangesText,u=t.selectedRangesTextColor,I=void 0===u?"#44aaff":u,u=t.selectedRangesTextOffset,H=void 0===u?[0,0]:u,u=this._getRulerScale(),d=this.width,v=this.height,y=(this.state.scrollPos=a,this.canvasContext),g="horizontal"===e,F=!1!==U,e=t.font||"10px sans-serif",_=t.textAlign||"left",q=t.textOffset||[0,0],m=g?v:d,b=tt("".concat(t.mainLineSize||"100%"),m),G=tt("".concat(t.longLineSize||10),m),V=tt("".concat(t.shortLineSize||7),m),x=t.lineOffset||[0,0];switch("transparent"===n?y.clearRect(0,0,d*u,v*u):(y.rect(0,0,d*u,v*u),y.fillStyle=n,y.fill()),y.save(),y.scale(u,u),y.strokeStyle=B,y.lineWidth=s,y.font=e,y.fillStyle=L,y.textAlign=_,h){case"start":y.textBaseline="top";break;case"center":y.textBaseline="middle";break;case"end":y.textBaseline="bottom"}y.translate(.5,0),y.beginPath();for(var w=g?d:v,O=l*f,S=Math.floor(a*l/O),Z=Math.ceil((a*l+w)/O)-S,J=Math.max(["left","center","right"].indexOf(_)-1,-1),P=g?v:d,C=[],E=0;E<=Z;++E){var R=(E+S)*f,k="".concat(R),K=(i&&(k=i(R)),y.measureText(k).width);C.push({color:L,offset:q,backgroundColor:N,value:R,text:k,textSize:K})}"transparent"!==W&&null!=c&&c.length&&c.forEach(function(t){var e=Math.max(t[0],p[0],U?-1/0:0),n=Math.min(t[1],p[1]),r=(e-a)*l,n=(n-e)*l;D&&t.forEach(function(t){var e="".concat(t),n=(i&&(e=i(t)),y.measureText(e).width),r=t*l,o=r+n;et(C,function(t,e){var n=t.value,t=t.textSize,n=n*l;n<=o&&r<=n+t&&C.splice(e,1)}),C.push({value:t,color:I,offset:H,text:e,textSize:n})}),n<=0||(y.save(),y.fillStyle=W,g?y.fillRect(r,0,n,P):y.fillRect(0,r,P,n),y.restore())}),"transparent"!==r&&p[0]!==-1/0&&p[1]!==1/0&&(m=(p[0]-a)*l,t=(p[1]-p[0])*l,y.save(),y.fillStyle=r,g?y.fillRect(m,0,t,P):y.fillRect(0,m,P,t),y.restore());for(E=0;E<=Z;++E){R=E+S;if(F||!(R<0))for(var Q=R*f,X=(Q-a)*l,z=0;z<o;++z){var j=X+z/o*O,T=Q+z/o*f;if(!(j<0||w<=j||T<p[0]||T>p[1])){var $=0===z?b:z%2==0?G:V,A=0;switch(h){case"start":A=0;break;case"center":A=P/2-$/2;break;case"end":A=P-$}var T=g?[j+x[0],A+x[1]]:[A+x[0],j+x[1]],j=T[0],T=T[1],M=g?[j,T+$]:[j+$,T],Y=M[0],M=M[1];y.moveTo(j+x[0],T+x[1]),y.lineTo(Y+x[0],M+x[1])}}}y.stroke(),C.forEach(function(t){var e=t.value,n=t.offset,r=t.backgroundColor,o=t.color,i=t.text,c=t.textSize;if(F||!(e<0)){t=(e-a)*l;if(!(t<-O||w+f*l<=t||e<p[0]||e>p[1])){var s=0;switch(h){case"start":s=17;break;case"center":s=P/2;break;case"end":s=P-17}e=g?[t+-3*J,s]:[s,t+3*J],t=e[0],e=e[1];if(r){var u=0;switch(_){case"left":u=0;break;case"center":u=-c/2;break;case"right":u=-c}y.save(),y.fillStyle=r,g?y.fillRect(t+n[0]+u,0,c,b):(y.translate(0,e+n[1]),y.rotate(-Math.PI/2),y.fillRect(u,0,c,b)),y.restore()}y.save(),y.fillStyle=o,g?y.fillText(i,t+n[0],e+n[1]):(y.translate(t+n[0],e+n[1]),y.rotate(-Math.PI/2),y.fillText(i,0,0)),y.restore()}}}),y.restore()},n._getRulerScale=function(){var t,e,n=this.props.defaultPixelScale||2;return this._rulerScale||(!(e=1<window.devicePixelRatio)&&window.matchMedia&&(e=(t=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)"))&&t.matches),this._rulerScale=e?3:n),this._rulerScale},o.defaultProps={type:"horizontal",zoom:1,width:0,height:0,unit:50,negativeRuler:!0,mainLineSize:"100%",longLineSize:10,shortLineSize:7,segment:10,direction:"end",style:{width:"100%",height:"100%"},backgroundColor:"#333333",font:"10px sans-serif",textColor:"#ffffff",textBackgroundColor:"transparent",lineColor:"#777777",range:[-1/0,1/0],rangeBackgroundColor:"transparent",lineWidth:1,selectedBackgroundColor:"#555555",defaultScrollPos:0},o}(G),X=["type","width","height","unit","zoom","direction","textAlign","font","segment","mainLineSize","longLineSize","shortLineSize","lineOffset","textOffset","negativeRuler","range","scrollPos","defaultScrollPos","style","backgroundColor","rangeBackgroundColor","lineColor","textColor","textBackgroundColor","textFormat","warpSelf","selectedBackgroundColor","selectedRanges","defaultPixelScale","useResizeObserver","selectedRangesText","selectedRangesTextColor","selectedRangesTextOffset"],t=["scroll","resize","getScrollPos"],Y=function(e){var t=o,n=e;if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}function o(t){t=e.call(this,t)||this;return t.state={},t.state=t.props,t}return i(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r),o.prototype.render=function(){return S(Q,c({ref:s(this,"ruler")},this.state))},o}(w),n=function(){function t(t,e){var n;void 0===e&&(e={}),this.containerProvider=null,this.selfElement=null,this._warp=!1,e.warpSelf?(delete e.warpSelf,this._warp=!0,n=t):(n=document.createElement("canvas"),t.appendChild(n)),$(S(Y,c({ref:s(this,"innerRuler")},e)),n)}var n,r,e=t.prototype;return e.scroll=function(t){this.getRuler().scroll(t)},e.resize=function(){this.getRuler().resize()},e.getScrollPos=function(){return this.getRuler().getScrollPos()},e.destroy=function(){var t,e=this.selfElement;$(null,e,this.containerProvider),this._warp||null!=(t=null==e?void 0:e.parentElement)&&t.removeChild(e),this.selfElement=null,this.innerRuler=null},e.getRuler=function(){return this.innerRuler.ruler},function(t,e,n,r){var o,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;0<=s;s--)(o=t[s])&&(c=(i<3?o(c):3<i?o(e,n,c):o(e,n))||c);return 3<i&&c&&Object.defineProperty(e,n,c),c}([(n=X,r=function(t,n){Object.defineProperty(t,n,{get:function(){return this.getRuler().props[n]},set:function(t){var e;this.innerRuler.setState(((e={})[n]=t,e))},enumerable:!0,configurable:!0})},function(t){var e=t.prototype;n.forEach(function(t){r(e,t)})})],t)}(),nt={__proto__:null,default:n,PROPERTIES:X,METHODS:t};for(e in nt)n[e]=nt[e];return n});
//# sourceMappingURL=ruler.min.js.map
