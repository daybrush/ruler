{"version":3,"file":"ruler.js","sources":["../../react-ruler/dist/ruler.esm.js","../src/consts.ts","../src/InnerRuler.tsx","../src/Ruler.tsx","../src/index.umd.ts"],"sourcesContent":["/*\nCopyright (c) 2019 Daybrush\nname: @scena/react-ruler\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/ruler/blob/master/packages/react-ruler\nversion: 0.14.2\n*/\nimport { version, createElement, PureComponent } from 'react';\nimport { ref } from 'framework-utils';\nimport { convertUnitSize } from '@daybrush/utils';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\nvar __assign = function () {\n  __assign = Object.assign || function __assign(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar Ruler =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Ruler, _super);\n\n  function Ruler() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      scrollPos: 0\n    };\n    _this.width = 0;\n    _this.height = 0;\n    _this._zoom = 0;\n    _this._rulerScale = 0;\n    _this._observer = null;\n\n    _this._checkResize = function () {\n      _this.resize();\n    };\n\n    return _this;\n  }\n\n  var __proto = Ruler.prototype;\n\n  __proto.render = function () {\n    var props = this.props;\n    var portalContainer = props.portalContainer;\n    var portalAttributes = {};\n\n    if ((version || \"\").indexOf(\"simple\") > -1 && portalContainer) {\n      portalAttributes = {\n        portalContainer: portalContainer\n      };\n    }\n\n    this._zoom = props.zoom;\n    return createElement(\"canvas\", __assign({\n      ref: ref(this, \"canvasElement\")\n    }, portalAttributes, {\n      style: this.props.style\n    }));\n  };\n\n  __proto.componentDidMount = function () {\n    var canvas = this.canvasElement;\n    var context = canvas.getContext(\"2d\", {\n      alpha: false\n    });\n    this.canvasContext = context;\n\n    if (this.props.useResizeObserver) {\n      this._observer = new ResizeObserver(this._checkResize);\n\n      this._observer.observe(canvas, {\n        box: \"border-box\"\n      });\n    } else {\n      this.resize();\n    }\n  };\n\n  __proto.componentDidUpdate = function () {\n    this.resize();\n  };\n\n  __proto.componentWillUnmount = function () {\n    var _a;\n\n    this.state.scrollPos = 0;\n    (_a = this._observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n  };\n  /**\n   * Gets the scroll position of the ruler.\n   */\n\n\n  __proto.getScrollPos = function () {\n    return this.state.scrollPos;\n  };\n  /**\n   * @method Ruler#scroll\n   * @param scrollPos\n   */\n\n\n  __proto.scroll = function (scrollPos, nextZoom) {\n    this.draw(scrollPos, nextZoom);\n  };\n  /**\n   * @method Ruler#resize\n   */\n\n\n  __proto.resize = function (nextZoom) {\n    var canvas = this.canvasElement;\n    var _a = this.props,\n        width = _a.width,\n        height = _a.height,\n        scrollPos = _a.scrollPos;\n\n    var rulerScale = this._getRulerScale();\n\n    this.width = width || canvas.offsetWidth;\n    this.height = height || canvas.offsetHeight;\n    canvas.width = this.width * rulerScale;\n    canvas.height = this.height * rulerScale;\n    this.draw(scrollPos, nextZoom);\n  };\n\n  __proto.draw = function (scrollPos, nextZoom) {\n    if (scrollPos === void 0) {\n      scrollPos = this.state.scrollPos;\n    }\n\n    if (nextZoom === void 0) {\n      nextZoom = this._zoom;\n    }\n\n    this._zoom = nextZoom;\n    var props = this.props;\n    var _a = props,\n        unit = _a.unit,\n        type = _a.type,\n        backgroundColor = _a.backgroundColor,\n        lineColor = _a.lineColor,\n        textColor = _a.textColor,\n        textBackgroundColor = _a.textBackgroundColor,\n        direction = _a.direction,\n        _b = _a.negativeRuler,\n        negativeRuler = _b === void 0 ? true : _b,\n        _c = _a.segment,\n        segment = _c === void 0 ? 10 : _c,\n        textFormat = _a.textFormat,\n        _d = _a.range,\n        range = _d === void 0 ? [-Infinity, Infinity] : _d,\n        rangeBackgroundColor = _a.rangeBackgroundColor,\n        selectedRanges = _a.selectedRanges,\n        selectedBackgroundColor = _a.selectedBackgroundColor,\n        _e = _a.lineWidth,\n        lineWidth = _e === void 0 ? 1 : _e;\n\n    var rulerScale = this._getRulerScale();\n\n    var width = this.width;\n    var height = this.height;\n    var state = this.state;\n    state.scrollPos = scrollPos;\n    var context = this.canvasContext;\n    var isHorizontal = type === \"horizontal\";\n    var isNegative = negativeRuler !== false;\n    var font = props.font || \"10px sans-serif\";\n    var textAlign = props.textAlign || \"left\";\n    var textOffset = props.textOffset || [0, 0];\n    var containerSize = isHorizontal ? height : width;\n    var mainLineSize = convertUnitSize(\"\".concat(props.mainLineSize || \"100%\"), containerSize);\n    var longLineSize = convertUnitSize(\"\".concat(props.longLineSize || 10), containerSize);\n    var shortLineSize = convertUnitSize(\"\".concat(props.shortLineSize || 7), containerSize);\n    var lineOffset = props.lineOffset || [0, 0];\n\n    if (backgroundColor === \"transparent\") {\n      // Clear existing paths & text\n      context.clearRect(0, 0, width * rulerScale, height * rulerScale);\n    } else {\n      // Draw the background\n      context.rect(0, 0, width * rulerScale, height * rulerScale);\n      context.fillStyle = backgroundColor;\n      context.fill();\n    }\n\n    context.save();\n    context.scale(rulerScale, rulerScale);\n    context.strokeStyle = lineColor;\n    context.lineWidth = lineWidth;\n    context.font = font;\n    context.fillStyle = textColor;\n\n    switch (direction) {\n      case \"start\":\n        context.textBaseline = \"top\";\n        break;\n\n      case \"center\":\n        context.textBaseline = \"middle\";\n        break;\n\n      case \"end\":\n        context.textBaseline = \"bottom\";\n        break;\n    }\n\n    context.translate(0.5, 0);\n    context.beginPath();\n    var size = isHorizontal ? width : height;\n    var zoomUnit = nextZoom * unit;\n    var minRange = Math.floor(scrollPos * nextZoom / zoomUnit);\n    var maxRange = Math.ceil((scrollPos * nextZoom + size) / zoomUnit);\n    var length = maxRange - minRange;\n    var alignOffset = Math.max([\"left\", \"center\", \"right\"].indexOf(textAlign) - 1, -1);\n    var barSize = isHorizontal ? height : width; // Draw Selected Range Background\n\n    if (selectedBackgroundColor !== \"transparent\" && (selectedRanges === null || selectedRanges === void 0 ? void 0 : selectedRanges.length)) {\n      selectedRanges.forEach(function (selectedRange) {\n        var rangeStart = Math.max(selectedRange[0], range[0], negativeRuler ? -Infinity : 0);\n        var rangeEnd = Math.min(selectedRange[1], range[1]);\n        var rangeX = (rangeStart - scrollPos) * nextZoom;\n        var rangeWidth = (rangeEnd - rangeStart) * nextZoom;\n\n        if (rangeWidth <= 0) {\n          return;\n        }\n\n        context.save();\n        context.fillStyle = selectedBackgroundColor;\n\n        if (isHorizontal) {\n          context.fillRect(rangeX, 0, rangeWidth, barSize);\n        } else {\n          context.fillRect(0, rangeX, barSize, rangeWidth);\n        }\n\n        context.restore();\n      });\n    } // Draw Range Background\n\n\n    if (rangeBackgroundColor !== \"transparent\" && range[0] !== -Infinity && range[1] !== Infinity) {\n      var rangeStart = (range[0] - scrollPos) * nextZoom;\n      var rangeEnd = (range[1] - range[0]) * nextZoom;\n      context.save();\n      context.fillStyle = rangeBackgroundColor;\n\n      if (isHorizontal) {\n        context.fillRect(rangeStart, 0, rangeEnd, barSize);\n      } else {\n        context.fillRect(0, rangeStart, barSize, rangeEnd);\n      }\n\n      context.restore();\n    } // Render Segments First\n\n\n    for (var i = 0; i <= length; ++i) {\n      var value = i + minRange;\n\n      if (!isNegative && value < 0) {\n        continue;\n      }\n\n      var startValue = value * unit;\n      var startPos = (startValue - scrollPos) * nextZoom;\n\n      for (var j = 0; j < segment; ++j) {\n        var pos = startPos + j / segment * zoomUnit;\n        var value_1 = startValue + j / segment * unit;\n\n        if (pos < 0 || pos >= size || value_1 < range[0] || value_1 > range[1]) {\n          continue;\n        }\n\n        var lineSize = j === 0 ? mainLineSize : j % 2 === 0 ? longLineSize : shortLineSize;\n        var origin = 0;\n\n        switch (direction) {\n          case \"start\":\n            origin = 0;\n            break;\n\n          case \"center\":\n            origin = barSize / 2 - lineSize / 2;\n            break;\n\n          case \"end\":\n            origin = barSize - lineSize;\n            break;\n        }\n\n        var _f = isHorizontal ? [pos + lineOffset[0], origin + lineOffset[1]] : [origin + lineOffset[0], pos + lineOffset[1]],\n            x1 = _f[0],\n            y1 = _f[1];\n\n        var _g = isHorizontal ? [x1, y1 + lineSize] : [x1 + lineSize, y1],\n            x2 = _g[0],\n            y2 = _g[1];\n\n        context.moveTo(x1 + lineOffset[0], y1 + lineOffset[1]);\n        context.lineTo(x2 + lineOffset[0], y2 + lineOffset[1]);\n      }\n    }\n\n    context.stroke(); // Render Labels\n\n    for (var i = 0; i <= length; ++i) {\n      var value = i + minRange;\n\n      if (!isNegative && value < 0) {\n        continue;\n      }\n\n      var startValue = value * unit;\n      var startPos = (startValue - scrollPos) * nextZoom;\n\n      if (startPos < -zoomUnit || startPos >= size + unit * nextZoom || startValue < range[0] || startValue > range[1]) {\n        continue;\n      }\n\n      var origin = 0;\n\n      switch (direction) {\n        case \"start\":\n          origin = 17;\n          break;\n\n        case \"center\":\n          origin = barSize / 2;\n          break;\n\n        case \"end\":\n          origin = barSize - 17;\n          break;\n      }\n\n      var _h = isHorizontal ? [startPos + alignOffset * -3, origin] : [origin, startPos + alignOffset * 3],\n          startX = _h[0],\n          startY = _h[1];\n\n      var text = \"\".concat(startValue);\n\n      if (textFormat) {\n        text = textFormat(startValue);\n      }\n\n      context.textAlign = textAlign;\n      var backgroundOffset = 0;\n      var textSize = context.measureText(text).width;\n\n      switch (textAlign) {\n        case \"left\":\n          backgroundOffset = 0;\n          break;\n\n        case \"center\":\n          backgroundOffset = -textSize / 2;\n          break;\n\n        case \"right\":\n          backgroundOffset = -textSize;\n          break;\n      }\n\n      if (isHorizontal) {\n        context.save();\n        context.fillStyle = textBackgroundColor;\n        context.fillRect(startX + textOffset[0] + backgroundOffset, 0, textSize, mainLineSize);\n        context.restore();\n      } else {\n        context.save();\n        context.translate(0, startY + textOffset[1]);\n        context.rotate(-Math.PI / 2);\n        context.fillStyle = textBackgroundColor;\n        context.fillRect(backgroundOffset, 0, textSize, mainLineSize);\n        context.restore();\n      }\n\n      if (isHorizontal) {\n        context.fillText(text, startX + textOffset[0], startY + textOffset[1]);\n      } else {\n        context.save();\n        context.translate(startX + textOffset[0], startY + textOffset[1]);\n        context.rotate(-Math.PI / 2);\n        context.fillText(text, 0, 0);\n        context.restore();\n      }\n    }\n\n    context.restore();\n  };\n\n  __proto._getRulerScale = function () {\n    var defaultPixelScale = this.props.defaultPixelScale || 2;\n\n    if (!this._rulerScale) {\n      var isHighDensity = window.devicePixelRatio > 1;\n\n      if (!isHighDensity && window.matchMedia) {\n        var mq = window.matchMedia('only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)');\n        isHighDensity = mq && mq.matches;\n      }\n\n      this._rulerScale = isHighDensity ? 3 : defaultPixelScale;\n    }\n\n    return this._rulerScale;\n  };\n\n  Ruler.defaultProps = {\n    type: \"horizontal\",\n    zoom: 1,\n    width: 0,\n    height: 0,\n    unit: 50,\n    negativeRuler: true,\n    mainLineSize: \"100%\",\n    longLineSize: 10,\n    shortLineSize: 7,\n    segment: 10,\n    direction: \"end\",\n    style: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    backgroundColor: \"#333333\",\n    font: \"10px sans-serif\",\n    textColor: \"#ffffff\",\n    textBackgroundColor: 'transparent',\n    lineColor: \"#777777\",\n    range: [-Infinity, Infinity],\n    rangeBackgroundColor: 'transparent',\n    lineWidth: 1,\n    selectedBackgroundColor: \"#555555\"\n  };\n  return Ruler;\n}(PureComponent);\n\nvar PROPERTIES = [\"type\", \"width\", \"height\", \"unit\", \"zoom\", \"direction\", \"textAlign\", \"font\", \"segment\", \"mainLineSize\", \"longLineSize\", \"shortLineSize\", \"lineOffset\", \"textOffset\", \"negativeRuler\", \"range\", \"scrollPos\", \"style\", \"backgroundColor\", \"rangeBackgroundColor\", \"lineColor\", \"textColor\", \"textBackgroundColor\", \"textFormat\", \"portalContainer\", \"selectedBackgroundColor\", \"selectedRanges\", \"defaultPixelScale\", \"useResizeObserver\"];\nvar METHODS = [\"scroll\", \"resize\", \"getScrollPos\"];\n\nexport default Ruler;\nexport { METHODS, PROPERTIES };\n//# sourceMappingURL=ruler.esm.js.map\n","import { RulerProps, RulerInterface } from \"@scena/react-ruler/declaration/types\";\nimport {\n    PROPERTIES as RULER_PROPERTIES,\n    METHODS as RULER_METHODS,\n} from \"@scena/react-ruler\";\n\nexport const PROPERTIES: Array<keyof RulerProps> = RULER_PROPERTIES;\nexport const METHODS: Array<keyof RulerInterface> = RULER_METHODS;\n","import * as React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { ref } from \"framework-utils\";\nimport ReactRuler from \"@scena/react-ruler\";\nimport { InnerRulerProps } from \"./types\";\n\nexport default class InnerRuler extends React.Component<InnerRulerProps, InnerRulerProps> {\n    public state: InnerRulerProps = {};\n    public ruler: ReactRuler;\n    constructor(props: InnerRulerProps) {\n        super(props);\n        this.state = this.props;\n    }\n    public render() {\n        const { parentElement, ...state } = this.state;\n\n        return createPortal(<ReactRuler ref={ref(this, \"ruler\")} {...state} />, parentElement);\n    }\n}\n","import { ref, Properties } from \"framework-utils\";\nimport * as React from \"react\";\nimport { render } from \"react-dom\";\nimport { PROPERTIES } from \"./consts\";\nimport { RulerInterface, RulerProps } from \"@scena/react-ruler/declaration/types\";\nimport InnerRuler from \"./InnerRuler\";\n\n\n/**\n * A Ruler component that can draw grids and scroll infinitely.\n * @sort 1\n * @implements Ruler.RulerInterface\n */\n@Properties(PROPERTIES, (prototype, property) => {\n    Object.defineProperty(prototype, property, {\n        get() {\n            return this.getRuler().props[property];\n        },\n        set(value) {\n            this.innerRuler.setState({\n                [property]: value,\n            });\n        },\n        enumerable: true,\n        configurable: true,\n    });\n})\nclass Ruler implements RulerInterface {\n    private tempElement = document.createElement(\"div\");\n    private innerRuler!: InnerRuler;\n    /**\n     * @param - container\n     * @param {$ts:Partial<Ruler.RulerProps>} options - options\n     */\n    constructor(parentElement: HTMLElement, options: Partial<RulerProps> = {}) {\n        render(\n            <InnerRuler ref={ref(this, \"innerRuler\")}\n                {...options} parentElement={parentElement} />,\n            this.tempElement,\n        );\n    }\n    public scroll(scrollPos: number) {\n        this.getRuler().scroll(scrollPos);\n    }\n    public resize() {\n        this.getRuler().resize();\n    }\n    public getScrollPos() {\n        return this.getRuler().getScrollPos();\n    }\n    /**\n     * Remove Ruler\n     */\n    public destroy() {\n        render(null, this.tempElement);\n        this.tempElement = null;\n        this.innerRuler = null;\n    }\n    private getRuler() {\n        return this.innerRuler.ruler;\n    }\n}\n\nexport default Ruler;\n","import Ruler, * as others from \"./index.esm\";\n\nfor (const name in others) {\n    (Ruler as any)[name] = others[name];\n}\n\nexport default Ruler;\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","Ruler","_super","_this","state","scrollPos","width","height","_zoom","_rulerScale","_observer","_checkResize","resize","__proto","render","props","portalContainer","portalAttributes","version","indexOf","zoom","createElement","ref","style","componentDidMount","canvas","canvasElement","context","getContext","alpha","canvasContext","useResizeObserver","ResizeObserver","observe","box","componentDidUpdate","componentWillUnmount","_a","disconnect","getScrollPos","scroll","nextZoom","draw","rulerScale","_getRulerScale","offsetWidth","offsetHeight","unit","type","backgroundColor","lineColor","textColor","textBackgroundColor","direction","_b","negativeRuler","_c","segment","textFormat","_d","range","Infinity","rangeBackgroundColor","selectedRanges","selectedBackgroundColor","_e","lineWidth","isHorizontal","isNegative","font","textAlign","textOffset","containerSize","mainLineSize","convertUnitSize","concat","longLineSize","shortLineSize","lineOffset","clearRect","rect","fillStyle","fill","save","scale","strokeStyle","textBaseline","translate","beginPath","size","zoomUnit","minRange","Math","floor","maxRange","ceil","alignOffset","max","barSize","forEach","selectedRange","rangeStart","rangeEnd","min","rangeX","rangeWidth","fillRect","restore","value","startValue","startPos","j","pos","value_1","lineSize","origin","_f","x1","y1","_g","x2","y2","moveTo","lineTo","stroke","_h","startX","startY","text","backgroundOffset","textSize","measureText","rotate","PI","fillText","defaultPixelScale","isHighDensity","window","devicePixelRatio","matchMedia","mq","matches","defaultProps","PureComponent","PROPERTIES","METHODS","RULER_PROPERTIES","RULER_METHODS","parentElement","createPortal","React","ReactRuler","options","document","InnerRuler","tempElement","getRuler","innerRuler","ruler","Properties","property","defineProperty","get","set","setState","enumerable","configurable","name","others"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}