{"version":3,"file":"ruler.js","sources":["../../react-ruler/dist/ruler.esm.js","../src/consts.ts","../src/InnerRuler.tsx","../src/Ruler.tsx","../src/index.umd.ts"],"sourcesContent":["/*\nCopyright (c) 2019 Daybrush\nname: @scena/react-ruler\nlicense: MIT\nauthor: Daybrush\nrepository: https://github.com/daybrush/ruler/blob/master/packages/react-ruler\nversion: 0.17.0\n*/\nimport { createElement, PureComponent } from 'react';\nimport { ref } from 'framework-utils';\nimport { convertUnitSize, findIndex } from '@daybrush/utils';\n\n/******************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\n\n/* global Reflect, Promise */\nvar extendStatics = function (d, b) {\n  extendStatics = Object.setPrototypeOf || {\n    __proto__: []\n  } instanceof Array && function (d, b) {\n    d.__proto__ = b;\n  } || function (d, b) {\n    for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n  };\n\n  return extendStatics(d, b);\n};\n\nfunction __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n\n  function __() {\n    this.constructor = d;\n  }\n\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nvar Ruler =\n/*#__PURE__*/\nfunction (_super) {\n  __extends(Ruler, _super);\n\n  function Ruler() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n\n    _this.state = {\n      scrollPos: 0\n    };\n    _this.width = 0;\n    _this.height = 0;\n    _this._zoom = 0;\n    _this._rulerScale = 0;\n    _this._observer = null;\n\n    _this._checkResize = function () {\n      _this.resize();\n    };\n\n    return _this;\n  }\n\n  var __proto = Ruler.prototype;\n\n  __proto.render = function () {\n    var props = this.props;\n    this._zoom = props.zoom;\n    return createElement(\"canvas\", {\n      ref: ref(this, \"canvasElement\"),\n      style: this.props.style\n    });\n  };\n\n  __proto.componentDidMount = function () {\n    var props = this.props;\n    this.state.scrollPos = props.defaultScrollPos || 0;\n    var canvas = this.canvasElement;\n    var context = canvas.getContext(\"2d\", {\n      alpha: false\n    });\n    this.canvasContext = context;\n\n    if (props.useResizeObserver) {\n      this._observer = new ResizeObserver(this._checkResize);\n\n      this._observer.observe(canvas, {\n        box: \"border-box\"\n      });\n    } else {\n      this.resize();\n    }\n  };\n\n  __proto.componentDidUpdate = function () {\n    this.resize();\n  };\n\n  __proto.componentWillUnmount = function () {\n    var _a;\n\n    this.state.scrollPos = 0;\n    (_a = this._observer) === null || _a === void 0 ? void 0 : _a.disconnect();\n  };\n  /**\n   * Gets the scroll position of the ruler.\n   */\n\n\n  __proto.getScrollPos = function () {\n    return this.state.scrollPos;\n  };\n  /**\n   * @method Ruler#scroll\n   * @param scrollPos\n   */\n\n\n  __proto.scroll = function (scrollPos, nextZoom) {\n    this.draw(scrollPos, nextZoom);\n  };\n  /**\n   * @method Ruler#resize\n   */\n\n\n  __proto.resize = function (nextZoom) {\n    var canvas = this.canvasElement;\n    var _a = this.props,\n        width = _a.width,\n        height = _a.height,\n        scrollPos = _a.scrollPos;\n\n    var rulerScale = this._getRulerScale();\n\n    this.width = width || canvas.offsetWidth;\n    this.height = height || canvas.offsetHeight;\n    canvas.width = this.width * rulerScale;\n    canvas.height = this.height * rulerScale;\n    this.draw(scrollPos, nextZoom);\n  };\n\n  __proto.draw = function (scrollPos, nextZoom) {\n    if (scrollPos === void 0) {\n      scrollPos = this.state.scrollPos;\n    }\n\n    if (nextZoom === void 0) {\n      nextZoom = this._zoom;\n    }\n\n    this._zoom = nextZoom;\n    var props = this.props;\n    var _a = props,\n        unit = _a.unit,\n        type = _a.type,\n        backgroundColor = _a.backgroundColor,\n        lineColor = _a.lineColor,\n        textColor = _a.textColor,\n        textBackgroundColor = _a.textBackgroundColor,\n        direction = _a.direction,\n        _b = _a.negativeRuler,\n        negativeRuler = _b === void 0 ? true : _b,\n        _c = _a.segment,\n        segment = _c === void 0 ? 10 : _c,\n        textFormat = _a.textFormat,\n        _d = _a.range,\n        range = _d === void 0 ? [-Infinity, Infinity] : _d,\n        rangeBackgroundColor = _a.rangeBackgroundColor,\n        selectedRanges = _a.selectedRanges,\n        selectedBackgroundColor = _a.selectedBackgroundColor,\n        _e = _a.lineWidth,\n        lineWidth = _e === void 0 ? 1 : _e,\n        selectedRangesText = _a.selectedRangesText,\n        _f = _a.selectedRangesTextColor,\n        selectedRangesTextColor = _f === void 0 ? \"#44aaff\" : _f,\n        _g = _a.selectedRangesTextOffset,\n        selectedRangesTextOffset = _g === void 0 ? [0, 0] : _g;\n\n    var rulerScale = this._getRulerScale();\n\n    var width = this.width;\n    var height = this.height;\n    var state = this.state;\n    state.scrollPos = scrollPos;\n    var context = this.canvasContext;\n    var isHorizontal = type === \"horizontal\";\n    var isNegative = negativeRuler !== false;\n    var font = props.font || \"10px sans-serif\";\n    var textAlign = props.textAlign || \"left\";\n    var textOffset = props.textOffset || [0, 0];\n    var containerSize = isHorizontal ? height : width;\n    var mainLineSize = convertUnitSize(\"\".concat(props.mainLineSize || \"100%\"), containerSize);\n    var longLineSize = convertUnitSize(\"\".concat(props.longLineSize || 10), containerSize);\n    var shortLineSize = convertUnitSize(\"\".concat(props.shortLineSize || 7), containerSize);\n    var lineOffset = props.lineOffset || [0, 0];\n\n    if (backgroundColor === \"transparent\") {\n      // Clear existing paths & text\n      context.clearRect(0, 0, width * rulerScale, height * rulerScale);\n    } else {\n      // Draw the background\n      context.rect(0, 0, width * rulerScale, height * rulerScale);\n      context.fillStyle = backgroundColor;\n      context.fill();\n    }\n\n    context.save();\n    context.scale(rulerScale, rulerScale);\n    context.strokeStyle = lineColor;\n    context.lineWidth = lineWidth;\n    context.font = font;\n    context.fillStyle = textColor;\n\n    switch (direction) {\n      case \"start\":\n        context.textBaseline = \"top\";\n        break;\n\n      case \"center\":\n        context.textBaseline = \"middle\";\n        break;\n\n      case \"end\":\n        context.textBaseline = \"bottom\";\n        break;\n    }\n\n    context.translate(0.5, 0);\n    context.beginPath();\n    var size = isHorizontal ? width : height;\n    var zoomUnit = nextZoom * unit;\n    var minRange = Math.floor(scrollPos * nextZoom / zoomUnit);\n    var maxRange = Math.ceil((scrollPos * nextZoom + size) / zoomUnit);\n    var length = maxRange - minRange;\n    var alignOffset = Math.max([\"left\", \"center\", \"right\"].indexOf(textAlign) - 1, -1);\n    var barSize = isHorizontal ? height : width;\n    var values = [];\n\n    for (var i = 0; i <= length; ++i) {\n      values.push({\n        color: textColor,\n        offset: textOffset,\n        backgroundColor: textBackgroundColor,\n        value: (i + minRange) * unit\n      });\n    } // Draw Selected Range Background\n\n\n    if (selectedBackgroundColor !== \"transparent\" && (selectedRanges === null || selectedRanges === void 0 ? void 0 : selectedRanges.length)) {\n      selectedRanges.forEach(function (selectedRange) {\n        var rangeStart = Math.max(selectedRange[0], range[0], negativeRuler ? -Infinity : 0);\n        var rangeEnd = Math.min(selectedRange[1], range[1]);\n        var rangeX = (rangeStart - scrollPos) * nextZoom;\n        var rangeWidth = (rangeEnd - rangeStart) * nextZoom;\n\n        if (selectedRangesText) {\n          selectedRange.forEach(function (value) {\n            var index = findIndex(values, function (_a) {\n              var prevValue = _a.value;\n              return prevValue === value;\n            });\n\n            if (index > -1) {\n              values.splice(index, 1);\n            }\n\n            values.push({\n              value: value,\n              color: selectedRangesTextColor,\n              offset: selectedRangesTextOffset\n            });\n          });\n        }\n\n        if (rangeWidth <= 0) {\n          return;\n        }\n\n        context.save();\n        context.fillStyle = selectedBackgroundColor;\n\n        if (isHorizontal) {\n          context.fillRect(rangeX, 0, rangeWidth, barSize);\n        } else {\n          context.fillRect(0, rangeX, barSize, rangeWidth);\n        }\n\n        context.restore();\n      });\n    } // Draw Range Background\n\n\n    if (rangeBackgroundColor !== \"transparent\" && range[0] !== -Infinity && range[1] !== Infinity) {\n      var rangeStart = (range[0] - scrollPos) * nextZoom;\n      var rangeEnd = (range[1] - range[0]) * nextZoom;\n      context.save();\n      context.fillStyle = rangeBackgroundColor;\n\n      if (isHorizontal) {\n        context.fillRect(rangeStart, 0, rangeEnd, barSize);\n      } else {\n        context.fillRect(0, rangeStart, barSize, rangeEnd);\n      }\n\n      context.restore();\n    } // Render Segments First\n\n\n    for (var i = 0; i <= length; ++i) {\n      var value = i + minRange;\n\n      if (!isNegative && value < 0) {\n        continue;\n      }\n\n      var startValue = value * unit;\n      var startPos = (startValue - scrollPos) * nextZoom;\n\n      for (var j = 0; j < segment; ++j) {\n        var pos = startPos + j / segment * zoomUnit;\n        var value_1 = startValue + j / segment * unit;\n\n        if (pos < 0 || pos >= size || value_1 < range[0] || value_1 > range[1]) {\n          continue;\n        }\n\n        var lineSize = j === 0 ? mainLineSize : j % 2 === 0 ? longLineSize : shortLineSize;\n        var origin = 0;\n\n        switch (direction) {\n          case \"start\":\n            origin = 0;\n            break;\n\n          case \"center\":\n            origin = barSize / 2 - lineSize / 2;\n            break;\n\n          case \"end\":\n            origin = barSize - lineSize;\n            break;\n        }\n\n        var _h = isHorizontal ? [pos + lineOffset[0], origin + lineOffset[1]] : [origin + lineOffset[0], pos + lineOffset[1]],\n            x1 = _h[0],\n            y1 = _h[1];\n\n        var _j = isHorizontal ? [x1, y1 + lineSize] : [x1 + lineSize, y1],\n            x2 = _j[0],\n            y2 = _j[1];\n\n        context.moveTo(x1 + lineOffset[0], y1 + lineOffset[1]);\n        context.lineTo(x2 + lineOffset[0], y2 + lineOffset[1]);\n      }\n    }\n\n    context.stroke(); // Render Labels\n\n    values.forEach(function (_a) {\n      var value = _a.value,\n          offset = _a.offset,\n          backgroundColor = _a.backgroundColor,\n          color = _a.color;\n\n      if (!isNegative && value < 0) {\n        return;\n      }\n\n      var startPos = (value - scrollPos) * nextZoom;\n\n      if (startPos < -zoomUnit || startPos >= size + unit * nextZoom || value < range[0] || value > range[1]) {\n        return;\n      }\n\n      var origin = 0;\n\n      switch (direction) {\n        case \"start\":\n          origin = 17;\n          break;\n\n        case \"center\":\n          origin = barSize / 2;\n          break;\n\n        case \"end\":\n          origin = barSize - 17;\n          break;\n      }\n\n      var _b = isHorizontal ? [startPos + alignOffset * -3, origin] : [origin, startPos + alignOffset * 3],\n          startX = _b[0],\n          startY = _b[1];\n\n      var text = \"\".concat(value);\n\n      if (textFormat) {\n        text = textFormat(value);\n      }\n\n      context.textAlign = textAlign;\n\n      if (backgroundColor) {\n        var backgroundOffset = 0;\n        var textSize = context.measureText(text).width;\n\n        switch (textAlign) {\n          case \"left\":\n            backgroundOffset = 0;\n            break;\n\n          case \"center\":\n            backgroundOffset = -textSize / 2;\n            break;\n\n          case \"right\":\n            backgroundOffset = -textSize;\n            break;\n        }\n\n        context.save();\n        context.fillStyle = backgroundColor;\n\n        if (isHorizontal) {\n          context.fillRect(startX + offset[0] + backgroundOffset, 0, textSize, mainLineSize);\n        } else {\n          context.translate(0, startY + offset[1]);\n          context.rotate(-Math.PI / 2);\n          context.fillRect(backgroundOffset, 0, textSize, mainLineSize);\n        }\n\n        context.restore();\n      }\n\n      context.save();\n      context.fillStyle = color;\n\n      if (isHorizontal) {\n        context.fillText(text, startX + offset[0], startY + offset[1]);\n      } else {\n        context.translate(startX + offset[0], startY + offset[1]);\n        context.rotate(-Math.PI / 2);\n        context.fillText(text, 0, 0);\n      }\n\n      context.restore();\n    });\n    context.restore();\n  };\n\n  __proto._getRulerScale = function () {\n    var defaultPixelScale = this.props.defaultPixelScale || 2;\n\n    if (!this._rulerScale) {\n      var isHighDensity = window.devicePixelRatio > 1;\n\n      if (!isHighDensity && window.matchMedia) {\n        var mq = window.matchMedia('only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)');\n        isHighDensity = mq && mq.matches;\n      }\n\n      this._rulerScale = isHighDensity ? 3 : defaultPixelScale;\n    }\n\n    return this._rulerScale;\n  };\n\n  Ruler.defaultProps = {\n    type: \"horizontal\",\n    zoom: 1,\n    width: 0,\n    height: 0,\n    unit: 50,\n    negativeRuler: true,\n    mainLineSize: \"100%\",\n    longLineSize: 10,\n    shortLineSize: 7,\n    segment: 10,\n    direction: \"end\",\n    style: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    backgroundColor: \"#333333\",\n    font: \"10px sans-serif\",\n    textColor: \"#ffffff\",\n    textBackgroundColor: 'transparent',\n    lineColor: \"#777777\",\n    range: [-Infinity, Infinity],\n    rangeBackgroundColor: 'transparent',\n    lineWidth: 1,\n    selectedBackgroundColor: \"#555555\",\n    defaultScrollPos: 0\n  };\n  return Ruler;\n}(PureComponent);\n\nvar PROPERTIES = [\"type\", \"width\", \"height\", \"unit\", \"zoom\", \"direction\", \"textAlign\", \"font\", \"segment\", \"mainLineSize\", \"longLineSize\", \"shortLineSize\", \"lineOffset\", \"textOffset\", \"negativeRuler\", \"range\", \"scrollPos\", \"defaultScrollPos\", \"style\", \"backgroundColor\", \"rangeBackgroundColor\", \"lineColor\", \"textColor\", \"textBackgroundColor\", \"textFormat\", \"warpSelf\", \"selectedBackgroundColor\", \"selectedRanges\", \"defaultPixelScale\", \"useResizeObserver\", \"selectedRangesText\", \"selectedRangesTextColor\", \"selectedRangesTextOffset\"];\nvar METHODS = [\"scroll\", \"resize\", \"getScrollPos\"];\n\nexport default Ruler;\nexport { METHODS, PROPERTIES };\n//# sourceMappingURL=ruler.esm.js.map\n","import { RulerProps, RulerInterface } from \"@scena/react-ruler/declaration/types\";\nimport {\n    PROPERTIES as RULER_PROPERTIES,\n    METHODS as RULER_METHODS,\n} from \"@scena/react-ruler\";\n\nexport const PROPERTIES: Array<keyof RulerProps> = RULER_PROPERTIES;\nexport const METHODS: Array<keyof RulerInterface> = RULER_METHODS;\n","import * as React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { ref } from \"framework-utils\";\nimport ReactRuler from \"@scena/react-ruler\";\nimport { InnerRulerProps } from \"./types\";\n\nexport default class InnerRuler extends React.Component<InnerRulerProps, InnerRulerProps> {\n    public state: InnerRulerProps = {};\n    public ruler: ReactRuler;\n    constructor(props: InnerRulerProps) {\n        super(props);\n        this.state = this.props;\n    }\n    public render() {\n        return <ReactRuler ref={ref(this, \"ruler\")} {...this.state} />;\n    }\n}\n","import { ref, Properties } from \"framework-utils\";\nimport * as React from \"react\";\nimport { PROPERTIES } from \"./consts\";\nimport { RulerInterface, RulerProps } from \"@scena/react-ruler/declaration/types\";\nimport InnerRuler from \"./InnerRuler\";\nimport { ContainerProvider, renderSelf } from \"croact\";\n\n\n/**\n * A Ruler component that can draw grids and scroll infinitely.\n * @sort 1\n * @implements Ruler.RulerInterface\n */\n@Properties(PROPERTIES, (prototype, property) => {\n    Object.defineProperty(prototype, property, {\n        get() {\n            return this.getRuler().props[property];\n        },\n        set(value) {\n            this.innerRuler.setState({\n                [property]: value,\n            });\n        },\n        enumerable: true,\n        configurable: true,\n    });\n})\nclass Ruler implements RulerInterface {\n    private containerProvider: ContainerProvider | null = null;\n    private selfElement: HTMLElement | null = null;\n    private _warp = false;\n    private innerRuler!: InnerRuler;\n    /**\n     * @param - container\n     * @param {$ts:Partial<Ruler.RulerProps>} options - options\n     */\n    constructor(parentElement: HTMLElement, options: Partial<RulerProps> = {}) {\n        let selfElement!: HTMLElement;\n\n        if (options.warpSelf) {\n            delete options.warpSelf;\n            this._warp = true;\n            selfElement = parentElement;\n        } else {\n            selfElement = document.createElement(\"div\");\n            parentElement.appendChild(selfElement);\n        }\n        renderSelf(\n            <InnerRuler ref={ref(this, \"innerRuler\")}\n                {...options} />,\n            selfElement,\n        );\n    }\n    public scroll(scrollPos: number) {\n        this.getRuler().scroll(scrollPos);\n    }\n    public resize() {\n        this.getRuler().resize();\n    }\n    public getScrollPos() {\n        return this.getRuler().getScrollPos();\n    }\n    /**\n     * Remove Ruler\n     */\n    public destroy() {\n        const selfElement = this.selfElement!;\n\n        renderSelf(\n            null,\n            selfElement!,\n            this.containerProvider,\n        );\n        if (!this._warp) {\n            selfElement?.parentElement?.removeChild(selfElement);\n        }\n        this.selfElement = null;\n        this.innerRuler = null;\n    }\n    private getRuler() {\n        return this.innerRuler.ruler;\n    }\n}\n\nexport default Ruler;\n","import Ruler, * as others from \"./index.esm\";\n\nfor (const name in others) {\n    (Ruler as any)[name] = others[name];\n}\n\nexport default Ruler;\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","TypeError","String","__","constructor","create","Ruler","_super","_this","apply","arguments","state","scrollPos","width","height","_zoom","_rulerScale","_observer","_checkResize","resize","__proto","render","props","zoom","createElement","ref","style","componentDidMount","defaultScrollPos","canvas","canvasElement","context","getContext","alpha","canvasContext","useResizeObserver","ResizeObserver","observe","box","componentDidUpdate","componentWillUnmount","_a","disconnect","getScrollPos","scroll","nextZoom","draw","rulerScale","_getRulerScale","offsetWidth","offsetHeight","unit","type","backgroundColor","lineColor","textColor","textBackgroundColor","direction","_b","negativeRuler","_c","segment","textFormat","_d","range","Infinity","rangeBackgroundColor","selectedRanges","selectedBackgroundColor","_e","lineWidth","selectedRangesText","_f","selectedRangesTextColor","_g","selectedRangesTextOffset","isHorizontal","isNegative","font","textAlign","textOffset","containerSize","mainLineSize","convertUnitSize","concat","longLineSize","shortLineSize","lineOffset","clearRect","rect","fillStyle","fill","save","scale","strokeStyle","textBaseline","translate","beginPath","size","zoomUnit","minRange","Math","floor","maxRange","ceil","length","alignOffset","max","indexOf","barSize","values","i","push","color","offset","value","forEach","selectedRange","rangeStart","rangeEnd","min","rangeX","rangeWidth","index","findIndex","prevValue","splice","fillRect","restore","startValue","startPos","j","pos","value_1","lineSize","origin","_h","x1","y1","_j","x2","y2","moveTo","lineTo","stroke","startX","startY","text","backgroundOffset","textSize","measureText","rotate","PI","fillText","defaultPixelScale","isHighDensity","window","devicePixelRatio","matchMedia","mq","matches","defaultProps","PureComponent","PROPERTIES","METHODS","RULER_PROPERTIES","RULER_METHODS","React","ReactRuler","parentElement","options","selfElement","warpSelf","_warp","document","appendChild","renderSelf","InnerRuler","getRuler","containerProvider","removeChild","innerRuler","ruler","Properties","property","defineProperty","get","set","setState","enumerable","configurable","name","others"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}